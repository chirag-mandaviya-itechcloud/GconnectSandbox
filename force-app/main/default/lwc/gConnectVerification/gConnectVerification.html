<!--
   @description       :
   @author            : Dhruv Javiya
   @group             :
   @last modified on  : 14-04-2025
   @last modified by  : Dhruv Javiya
   -->
<template>
    <!-- Add the viewport meta tag here -->
    <div class="overrideStyle"></div>
    <template if:true={spinner}>
        <div class="slds-align--absolute-center">
            <lightning-spinner variant="brand" size="small"></lightning-spinner>
        </div>
    </template>
    <!-- ==================================== SC FLOW START =========================================================== -->
    <!-- Header -->
    <div class="container">
        <div class="header_info">
            <div><img src={DSPNavbarLogo} alt={mainContractorName}></div>
        </div>
    </div>
    <!-- 1. Login Screen -->
    <template if:true={signUpPage}>
        <div class="sign_up_sec">
            <div class="signUp">
                <div class="slds-grid slds-wrap">
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div>
                            <h2 class="title primaryContent">Welcome!</h2>
                            <div class="subtitle secondaryContent">Please enter your email address</div>
                        </div>
                    </div>
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-input label="Email" name="signUpEmail"
                            onchange={onchangeConfirmSave}></lightning-input>
                        <div style="color: red;">
                            {errorMessage}
                        </div>
                    </div>
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div class="slds-form-element">
                            <div class="slds-form-element__control">
                                <div class="slds-checkbox">
                                    <lightning-input class="checkboxInline" type="checkbox" name="GDPRStatement"
                                        checked={GDPRStatement} onchange={onchangeConfirmSave}
                                        id="checkbox-unique-id-81"></lightning-input>
                                    <label class="slds-checkbox__label" for="checkbox-unique-id-81">
                                        <span style="color: red;padding-right: 3px;">*</span>
                                        <span class="slds-form-element__label secondaryContent" onclick={opelGDPRModal}
                                            style="color: #2574A9 !important;text-decoration: underline;cursor: pointer;">GDPR
                                            Statement</span>
                                    </label>
                                </div>
                                <div style="color: red;" if:true={GDPRStatementError}>Please read the GDPR statment and
                                    verify it.</div>
                            </div>
                        </div>
                    </div>
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div class="slds-form-element">
                            <div class="slds-form-element__control">
                                <div class="slds-checkbox">
                                    <lightning-input class="checkboxInline termsandPrivacyValid" type="checkbox"
                                        name="signOffersNews" onchange={onchangeConfirmSave} id="checkbox-unique-id-82"
                                        checked={signOffersNews}></lightning-input>
                                    <label class="slds-checkbox__label" for="checkbox-unique-id-82">
                                        <span class="slds-form-element__label secondaryContent">Sign me up to receive
                                            updates, offers and news </span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div class="confirmbtn2">
                            <button onclick={callSignUp} class="confirmButton2">Confirm My Email</button>
                        </div>
                    </div>
                </div>
                <div class="power_by_logo"><img src={powerByLogo}></div>
            </div>
        </div>
        <template if:true={opelGDPRModalSection}>
            <section role="dialog" tabindex="-1" aria-modal="true" aria-labelledby="modal-heading-01"
                class="slds-modal slds-fade-in-open gdpr_modal">
                <div class="slds-modal__container">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                        title="Close" onclick={closeModal}>
                        <lightning-icon icon-name="utility:close" alternative-text="close" size="small"
                            onclick={closeGDPRModal} style="color: black;"></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <div class="slds-modal__header">
                        <h1 id="modal-heading-01" class="slds-modal__title slds-hyphenate" tabindex="-1">GDPR Statement
                        </h1>
                    </div>
                    <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                        <c-gdpr-statement-content></c-gdpr-statement-content>
                    </div>
                </div>
            </section>
            <div class="slds-backdrop slds-backdrop_open" role="presentation"></div>
        </template>
    </template>
    <!-- 5. Driving Licence Details -->
    <template if:true={confirmDrivingLicensePage}>
        <div class="confirm_details_sec">
            <div class="confirmDetails">
                <div class="slds-grid slds-wrap">
                    <!-- pattern="^[A-Z0-9]{5}\d[0156]\d([0][1-9]|[12]\d|3[01])\d[A-Z0-9]{3}[A-Z]{2}$"  // UK DL Code-->
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div>
                            <h2 class="title primaryContent">Driving Licence</h2>
                            <div class="subtitle Confirm your detail secondaryContent">Please enter your Driving Licence
                                details</div>
                        </div>
                    </div>
                    <div
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-combobox label="Type of licence" name="typeOfLicense" class="typeOfLicense"
                            value={typeOfLicense} onchange={onChangeLicenseDetails} options={licenseTypes_option}
                            placeholder="Select Type" required="true"
                            message-when-value-missing="Please select"></lightning-combobox>
                    </div>
                    <div
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-input label="Driving Licence Number" max-length="18" type="text" name="licenseNumber"
                            onchange={onChangeLicenseDetails} value={licenseNumber} class=licenseNumber required="true"
                            message-when-value-missing="Please add Licence number"
                            placeholder="Licence Number"></lightning-input>
                    </div>
                    <div
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-input label="Points on Licence" type="text" name="pointOfLicense"
                            onchange={onChangeLicenseDetails} value={pointOfLicense} class=pointOfLicense
                            placeholder="Add points here"></lightning-input>
                    </div>
                    <div
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-input label="Licence Expiry Date"
                            message-when-value-missing="Please add Licence Expiry Date" required="true"
                            placeholder="DD/MM/YYYY" date-style="short" type="date" name="licenseExpiryDate"
                            class="licenseExpiryDate" onchange={onChangeLicenseDetails} max={maxDate}
                            value={licenseExpiryDate}></lightning-input>
                    </div>
                    <div
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-input label="Licence Issue Date" message-when-value-missing="Please add Issue Date"
                            required="true" placeholder="DD/MM/YYYY" date-style="short" type="date"
                            name="licenseIssueDate" class="licenseIssueDate" onchange={onChangeLicenseDetails}
                            max={maxDate} value={licenseIssueDate}></lightning-input>
                    </div>
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <label class="slds-p-top_x-small"> Additional Licence Categories</label>
                        <div class="slds-p-around_xxx-small checkbox-inline">
                            <template if:true={licenseCategory_option}>
                                <template for:each={licenseCategory_option} for:item="cbOption">
                                    <lightning-input type="checkbox" label={cbOption.value} value={cbOption.value}
                                        key={cbOption.value} onchange={onChangeLicenseDetails}
                                        checked={cbOption.checked} class="cBox licenseCategory"
                                        name="licenseCategory"></lightning-input>
                                </template>
                            </template>
                        </div>
                        <div style="color: red;" if:true={showCboxCategoryError}>Please select at least one checkbox
                        </div>
                    </div>
                    <!-- show Validation error || 09-09-2025 -->
                    <!--div
                  class="editbtn slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                  <div style="color: red;text-align: center;font-size: medium;font-weight: bold;" if:true={showDrivingValidation}>{showDrivingValidationMessage}
                  </div>
                  </div-->
                    <div
                        class="editbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button class="editButton" onclick={callBackButton} name="drivingLicence">Back</button>
                        </div>
                    </div>
                    <div
                        class="confirmbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button onclick={callConfirmDrivingLicense} class="confirmButton">Next</button>
                        </div>
                    </div>
                </div>
                <div class="power_by_logo"><img src={powerByLogo}></div>
            </div>
        </div>
    </template>
    <!-- 6. Driving Licence Doc Upload -->
    <template if:true={confirmDLUploadPage}>
        <div class="confirm_details_sec">
            <div class="confirmDetails">
                <div class="slds-grid slds-wrap">
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div>
                            <h2 class="title primaryContent">Driving Licence Upload</h2>
                            <div class="subtitle Confirm your detail secondaryContent">Please add your Driving Licence
                                documents</div>
                        </div>
                    </div>
                    <div style="text-align: center;"
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <lightning-button icon-name="utility:upload" variant="brand" class="fileBtn" name="uploadType"
                            data-uploadtype="DL" label="File Upload" onclick={clickFrontBackUpload}>
                        </lightning-button>
                        <div style="color: red;" if:true={isDlDocError}>Please upload Driving Licence Documents</div>
                    </div>
                </div>
                <div class="slds-grid slds-wrap">
                    <div style="text-align: center;"
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_12-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <!-- Here Picture shows  -->
                        <template for:each={frontDLFiles} for:item="file">
                            <div key={file.id} class="items">
                                <template if:true={file.isImage}>
                                    <img src={file.preview} class="preview_imageDL" />
                                </template>
                                <template if:false={file.isImage}>
                                    <p style="text-overflow: ellipsis; overflow: hidden;">File not applicable for
                                        preview</p>
                                </template>
                            </div>
                        </template>
                    </div>
                    <div style="text-align: center;"
                        class="slds-col slds-large-size_6-of-12 slds-medium-size_12-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <template for:each={backDLFiles} for:item="file">
                            <div key={file.id} class="items">
                                <template if:true={file.isImage}>
                                    <img src={file.preview} class="preview_imageDL" />
                                </template>
                                <template if:false={file.isImage}>
                                    <p style="text-overflow: ellipsis; overflow: hidden;">File not applicable for
                                        preview</p>
                                </template>
                            </div>
                        </template>
                    </div>
                    <div
                        class="editbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button class="editButton" onclick={callBackButton}
                                name="drivingLicenceUpload">Back</button>
                        </div>
                    </div>
                    <div
                        class="confirmbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button onclick={callConfirmDLUploadDetails} class="confirmButton">Next</button>
                        </div>
                    </div>
                </div>
                <div class="power_by_logo"><img src={powerByLogo}></div>
            </div>
        </div>
    </template>
    <!-- 7. New RTW details -->
    <!-- 7. Right To Work -->
    <template if:true={confirmForm64Page}>
        <div class="connect-v2" style="padding-top: 35px; padding-bottom: 20px;">
            <div class="main">

                <div>
                    <div class="page-title">Right to Work</div>
                    <div class="page-subtitle">
                        Select the option that matches your citizenship or immigration status.
                    </div>
                </div>

                <!-- CATEGORY -->
                <div class="card">
                    <div class="card-body">

                        <div class="card-label">
                            Which of these applies to you?
                        </div>

                        <template for:each={categories} for:item="cat">
                            <div key={cat.id} data-id={cat.id} class={cat.cssClass} onclick={handleCategoryClick}>

                                <div class="category-radio">
                                    <div class="category-radio-inner"></div>
                                </div>

                                <div class="category-flag">
                                    {cat.flag}
                                </div>

                                <div class="category-content">
                                    <div class="category-name">
                                        {cat.label}
                                    </div>

                                    <template if:true={cat.description}>
                                        <div class="category-desc">
                                            {cat.description}
                                        </div>
                                    </template>
                                </div>
                            </div>
                        </template>

                    </div>
                </div>

                <!-- IRISH INFO -->
                <template if:true={showIrishInfo}>
                    <div class="info-callout irish-info">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <circle cx="12" cy="12" r="10"></circle>
                            <path d="M12 16v-4"></path>
                            <path d="M12 8h.01"></path>
                        </svg>
                        <div>
                            {selectedCategory.infoMessage}
                        </div>
                    </div>
                </template>

                <!-- EVIDENCE -->
                <template if:true={showEvidence}>
                    <div class="card">
                        <div class="card-body">

                            <div class="evidence-label">
                                Which document will you provide?
                            </div>

                            <template for:each={evidenceList} for:item="doc">
                                <div key={doc.id} data-id={doc.id} class={doc.cssClass} onclick={handleEvidenceClick}>

                                    <div class="evidence-radio">
                                        <div class="evidence-radio-inner"></div>
                                    </div>

                                    <div class="evidence-content">
                                        <div class="evidence-name">
                                            {doc.name}
                                        </div>
                                        <div class="evidence-desc">
                                            {doc.description}
                                        </div>
                                    </div>
                                </div>
                            </template>

                        </div>
                    </div>
                </template>

                <!-- SHARE CODE -->
                <template if:true={showShareCode1}>
                  <div class="card">
                     <div class="card-body">
                        <div class="evidence-label">
                              Enter your share code
                        </div>
                        
                        <div class="sharecode-note">
                              <svg viewBox="0 0 24 24" fill="none"
                                 stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round">
                                 <circle cx="12" cy="12" r="10"></circle>
                                 <line x1="12" y1="8" x2="12" y2="12"></line>
                                 <line x1="12" y1="16" x2="12.01" y2="16"></line>
                              </svg>

                              <div>
                                 {shareCodeData.line1}
                                 <br /><br />

                                 If you don't have one yet, go to&nbsp;
                                 <a href={shareCodeData.link}
                                    target="_blank">
                                    gov.uk/prove-right-to-work
                                 </a>&nbsp;
                                  to create one. Share codes are valid for 90 days.
                              </div>
                        </div>

                        <div style="margin-top: 16px;">
                           <div class="share-code-input-wrapper">
                              <div class="share-code-prefix">W</div>
                              <input
                                    type="text"
                                    name="shareCode"
                                    class="share-code-input"
                                    placeholder="Enter 8 characters"
                                    maxlength="8"
                                    value={shareCode}
                                    oninput={onChangeForm64Details}
                                    required
                              />
                           </div>
                        </div>
                     </div>
                  </div>
            </template>

                <div class="slds-grid slds-wrap" style="gap: inherit;">
                    <div
                        class="editbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button class="editButton" onclick={callBackButton} name="rtw">Back</button>
                        </div>
                    </div>
                    <div
                        class="confirmbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button onclick={callConfirmForm64} class="confirmButton">Next</button>
                        </div>
                    </div>
                </div>
                <div class="power_by_logo" style="max-width:480px; margin:0 auto;">
                    <img src={powerByLogo} alt="powered by" />
                </div>
            </div>
        </div>

    </template>

    <!-- RTW UPLOAD SCREEN -->
    <template if:true={confirmRTWUploadPage}>
        <div class="connect-v2">
            <div class="main" style="display: block;">

                <!-- child handles ALL upload / camera UI -->
                <c-rtw-upload record-id={recordId} upload-mode={uploadMode} document-type={currentUploadDocumentType}
                    selected-rtw-option={selectedRTWOption} rtw-files={RTWFiles}>
                </c-rtw-upload>

                <div class="slds-grid slds-wrap" style="gap: inherit;">
                    <div
                        class="editbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button class="editButton" onclick={callBackButton} name="rtwUpload">Back</button>
                        </div>
                    </div>
                    <div
                        class="confirmbtn slds-col slds-large-size_6-of-12 slds-medium-size_6-of-12 slds-size_6-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div style="display: flex;justify-content: center;">
                            <button onclick={callConfirmRTWUploadDetails} class="confirmButton">Next</button>
                        </div>
                    </div>
                </div>

                <div class="power_by_logo" style="max-width:480px; margin:0 auto;">
                    <img src={powerByLogo} alt="powered by" />
                </div>

            </div>
        </div>
    </template>

    <!-- Success Page -->
    <template if:true={successPage}>
        <div class="confirm_details_sec">
            <div class="confirmDetails">
                <div class="slds-grid slds-wrap">
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div>
                            <h2 class="title primaryContent">Verification Successful!</h2>
                            <div class="subtitle secondaryContent">Thank you for submitting your details. Your
                                information has been
                                successfully verified.</div>
                        </div>
                    </div>
                </div>
                <div class="power_by_logo"><img src={powerByLogo}></div>
            </div>
        </div>
    </template>

    <!--  -->
    <template if:true={alreadySubmittedPage}>
        <div class="confirm_details_sec">
            <div class="confirmDetails">
                <div class="slds-grid slds-wrap">
                    <div
                        class="slds-col slds-large-size_12-of-12 slds-medium-size_12-of-12 slds-size_12-of-12 slds-p-horizontal_medium slds-p-vertical_x-small">
                        <div>
                            <h2 class="title primaryContent">Verification Already Submitted!</h2>
                            <div class="subtitle secondaryContent">Thank you for submitting your details. Your
                                information has been
                                successfully verified.</div>
                        </div>
                    </div>
                </div>
                <div class="power_by_logo"><img src={powerByLogo}></div>
            </div>
        </div>
    </template>

  
    <!-- ==================================== SC FLOW END ============================================================ -->
    <template if:true={isProfileUploadOpned}>
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true"
            aria-describedby="modal-content-id-7" class="fileUploadModal slds-modal slds-fade-in-open">
            <div class="slds-modal__container">
                <!-- modal header start -->
                <header class="slds-modal__header">
                    <button class="slds-button slds-button_icon slds-modal__close slds-button_icon-inverse"
                        title="Close" onclick={handleFileCancel}>
                        <lightning-icon icon-name="utility:close" alternative-text="close" variant="inverse"
                            size="small"></lightning-icon>
                        <span class="slds-assistive-text">Close</span>
                    </button>
                    <h2 id="modal-heading-12" class="slds-text-heading_medium slds-hyphenate">Upload Documents</h2>
                </header>
                <!-- modal body start -->
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-12">
                    <div class="slds-grid slds-var-m-around_small">
                        <div class="slds-col slds-size_6-of-6">
                            <c-image-capture record-id={recordId} show-file-upload={showFileUploadModal}
                                show-profile={showProfileUploadModal} show-capture-file={showImageCaptureModal}
                                show-doc-error={isFileModuleError} show-error-message={fileModuleError}
                                document-names={selectedRTWDocumentNames}
                                show-front-back-radio-btn={showFrontBackRadioBtn}>
                            </c-image-capture>
                        </div>
                    </div>
                </div>
                <!-- modal footer start-->
                <footer class="slds-modal__footer deleteModal">
                    <button class="slds-button slds-button_neutral" onclick={handleFileCancel}>Cancel</button>
                    <button class="slds-button slds-button_brand btncolor"
                        onclick={handleSaveProfileFiles}>Save</button>
                </footer>
            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
    </template>
</template>